<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Income Tax Calculator with Callbacks</title>
<style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    input, button { margin: 5px 0; padding: 5px; }
    .result { margin-top: 20px; font-weight: bold; }
</style>
</head>
<body>

<h2>Income Tax Calculator</h2>

<form id="taxForm">
    <label>Full Name:</label><br>
    <input type="text" id="fullName" required><br>

    <label>PAN:</label><br>
    <input type="text" id="pan" maxlength="10" required><br>

    <label>Annual Income (₹):</label><br>
    <input type="number" id="income" min="0" required><br>

    <button type="submit">Calculate Tax</button>
</form>

<div class="result" id="resultDiv"></div>

<script>
const taxRecords = []; // JSON array for storing records

// Function to calculate tax
function calculateTax(name, pan, income, callback) {
    let tax = 0;

    if (income <= 250000) {
        tax = 0;
    } else if (income <= 500000) {
        tax = Math.round((income - 250000) * 0.05);
    } else if (income <= 1000000) {
        tax = Math.round(250000 * 0.05 + (income - 500000) * 0.2);
    } else {
        tax = Math.round(250000 * 0.05 + 500000 * 0.2 + (income - 1000000) * 0.3);
    }

    // Call the provided callback with all info
    callback({ name, pan, income, tax });
}

// Callback to log in console
function logToConsole(record) {
    console.log(`Name: ${record.name}`);
    console.log(`PAN: ${record.pan}`);
    console.log(`Annual Income: ₹${record.income}`);
    console.log(`Calculated Tax: ₹${record.tax}`);
}

// Callback to display on page
function displayOnPage(record) {
    const div = document.getElementById('resultDiv');
    div.innerHTML = `
        Name: ${record.name} <br>
        PAN: ${record.pan} <br>
        Annual Income: ₹${record.income} <br>
        Calculated Tax: ₹${record.tax}
    `;
}

// Callback to save in JSON array
function saveToRecords(record) {
    taxRecords.push(record);
    console.log("Tax records updated:", taxRecords);
}

// Handle form submission
document.getElementById('taxForm').addEventListener('submit', (e) => {
    e.preventDefault();

    const name = document.getElementById('fullName').value.trim();
    const pan = document.getElementById('pan').value.trim().toUpperCase();
    const income = Number(document.getElementById('income').value);

    // PAN validation
    const panRegex = /^[A-Z]{5}[0-9]{4}[A-Z]$/;
    if (!panRegex.test(pan)) {
        alert("Invalid PAN format. Example: ABCDE1234F");
        return;
    }

    // Call calculateTax with a main callback that triggers all 3 sub-callbacks
    calculateTax(name, pan, income, (record) => {
        logToConsole(record);
        displayOnPage(record);
        saveToRecords(record);
    });

    // Optionally reset the form
    document.getElementById('taxForm').reset();
});
</script>

</body>
</html>
